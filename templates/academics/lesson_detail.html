{% extends "base.html" %}
{% block title %}Урок · SmartGrade{% endblock %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb small mb-1">
        <li class="breadcrumb-item"><a href="{% url 'academics:lesson_list' %}">Уроки</a></li>
        <li class="breadcrumb-item active" aria-current="page">Урок</li>
      </ol>
    </nav>
    <h1 class="h5 m-0">
      <i class="bi bi-journal-text me-2 text-primary"></i>
      {{ lesson.subject|default:"Предмет" }} — {{ lesson.classroom|default:"Класс" }}
    </h1>
  </div>

  {% if request.user.is_authenticated and request.user.role == 'TEACHER' %}
  <div class="btn-group">
    <a href="{% url 'journal:attendance_new' %}" class="btn btn-outline-success btn-sm">
      <i class="bi bi-person-check me-1"></i>Отметить посещаемость
    </a>
    <a href="{% url 'journal:grade_new' %}" class="btn btn-outline-primary btn-sm">
      <i class="bi bi-plus-circle me-1"></i>Добавить оценку
    </a>
  </div>
  {% endif %}
</div>

<div class="card sg-card">
  <div class="card-body">

    <div class="d-flex flex-wrap gap-2 mb-3">
      <span class="badge text-bg-light border">
        <i class="bi bi-calendar2-week me-1"></i>{{ lesson.date|date:"j E Y" }}
      </span>
      <span class="badge rounded-pill text-bg-primary bg-opacity-10 text-primary">
        <i class="bi bi-people me-1"></i>{{ lesson.classroom|default:"—" }}
      </span>
      <span class="badge rounded-pill text-bg-warning bg-opacity-10 text-warning">
        <i class="bi bi-book-half me-1"></i>{{ lesson.subject|default:"—" }}
      </span>
    </div>

    <div class="row g-3 mb-3">
      <div class="col-md-4">
        <div class="small text-muted mb-1">Дата</div>
        <div class="fw-semibold">{{ lesson.date|date:"d.m.Y" }}</div>
      </div>
      <div class="col-md-4">
        <div class="small text-muted mb-1">Учитель</div>
        <div class="fw-semibold">
          {{ lesson.teacher.email|default:lesson.teacher|default:"—" }}
        </div>
      </div>

    <div class="mb-2">
      <div class="small text-muted mb-1"><i class="bi bi-chat-left-text me-1"></i>Тема</div>
      <div class="fs-6">{{ lesson.topic|default:"—" }}</div>
    </div>

    {% if lesson.description %}
    <hr>
    <div class="mb-2">
      <div class="small text-muted mb-1"><i class="bi bi-file-text me-1"></i>Описание</div>
      <div class="text-muted">{{ lesson.description }}</div>
    </div>
    {% endif %}
  </div>


  <div class="card-footer d-flex justify-content-between align-items-center">
    <a href="{% url 'academics:lesson_list' %}" class="btn btn-outline-secondary btn-sm">
      <i class="bi bi-arrow-left me-1"></i>К списку уроков
    </a>

    {% if request.user.is_authenticated and request.user.role == 'TEACHER' %}
    <div class="d-flex gap-2">
      <a href="{% url 'journal:attendance_new' %}" class="btn btn-success btn-sm">
        <i class="bi bi-person-check me-1"></i>Посещаемость
      </a>
      <a href="{% url 'journal:grade_new' %}" class="btn btn-primary btn-sm">
        <i class="bi bi-plus-circle me-1"></i>Оценка
      </a>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
